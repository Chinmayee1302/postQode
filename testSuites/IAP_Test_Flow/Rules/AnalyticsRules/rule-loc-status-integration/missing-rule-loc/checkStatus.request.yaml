id: 67a77318-138f-4862-9bdc-3c1600123b53
name: checkStatus
request:
  url:
    raw: >-
      {{API_Base_URL}}/interface/{{SYSTEM_ID}}/hospital/{{AssetManagement.hospitalDetails.HospitalId}}/assets.search
    host:
      - '{{API_Base_URL}}'
    path:
      - interface
      - '{{SYSTEM_ID}}'
      - hospital
      - '{{AssetManagement.hospitalDetails.HospitalId}}'
      - assets.search
  method: POST
  headers:
    - key: sec-ch-ua-platform
      value: '"Windows"'
    - key: Authorization
      value: >-
        Bearer
        eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwcmoiOiIwSDhFYW5RMEdlZmNPWVJqVjQ2d0w5IiwiaWF0IjoxNzY1MzQ4NTAwLCJleHAiOjE3NjU0MzQ5MDAsImF1ZCI6Ijk1NzhlMDQ2MGM5OGQ0YWRjMGY4N2Y3MCIsImlzcyI6Imh0dHBzOi8vc3RnLWNveC1oZWFsdGgtaW1hZ2luZS1hcGkubGV2ZXJlZ2UuY29tIiwic3ViIjoiMDJSWnVScTE0b1h5MWlwVGdXV3ZQNCJ9.FGgFvg50V-V2dhG9pzoqSoq9tubVIQumjRizifyaZm8
    - key: Referer
      value: https://stg-cognosos.web.app/
    - key: sec-ch-ua
      value: '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"'
    - key: sec-ch-ua-mobile
      value: '?0'
    - key: User-Agent
      value: >-
        Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
        like Gecko) Chrome/142.0.0.0 Safari/537.36
    - key: Accept
      value: application/json
    - key: Content-Type
      value: application/json
  body:
    mode: raw
    modeOfBody: JSON
    raw: >-
      {"limit":100,"offset":0,"filter":{"type":"exists","field":"data/tag/id","not":false},"sort":[{"field":"lastModified","order":"desc"}],"nextToken":null}
  auth:
    type: bearer
    bearer:
      token: '{{idToken}}'
events:
  - listen: prerequest
    script:
      type: javascript
      exec:
        - "setTimeout(() => {\r"
        - "  console.log(\"wait for 10 secs\")\r"
        - "}, 3000)\r"
        - "\r"
        - "for (let i = 0; i < 1000; i++){\r"
        - "  console.log(i)\r"
        - '}'
  - listen: test
    script:
      type: javascript
      exec:
        - "const response = pq.response.json()\r"
        - "response.items.forEach(ele => {\r"
        - "  if (ele.id === pq.environment.get(\"AssetManagement.rulesData.availableruleName.assetDetails.assetlevId\")) {\r"
        - "    pq.test(\"Verifying the asset Status\",()=> {\r"
        - "      pq.expect(ele.data.status.missing).to.be.true\r"
        - "    })\r"
        - "  }\r"
        - "   \r"
        - "})\r"
        - ''
type: request
