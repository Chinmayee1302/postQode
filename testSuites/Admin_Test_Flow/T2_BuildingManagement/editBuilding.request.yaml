id: 7f3081ae-fd42-4d34-8614-67da1fb8b72d
name: editBuilding
request:
  url:
    raw: >-
      {{API_Base_URL}}/project/{{PROJECT_ID}}/system/{{SYSTEM_ID}}/srv/prosightApiServer/building/{{BuildingId}}
    host:
    - '{{API_Base_URL}}'
    path:
    - project
    - '{{PROJECT_ID}}'
    - system
    - '{{SYSTEM_ID}}'
    - srv
    - prosightApiServer
    - building
    - '{{BuildingId}}'
  method: PUT
  headers:
  - description: ''
    disabled: false
    key: Cache-Control
    value: no-cache
  - description: ''
    disabled: false
    key: Accept
    value: '*/*'
  - description: ''
    disabled: false
    key: Accept-Encoding
    value: gzip, deflate
  - description: ''
    disabled: false
    key: Connection
    value: keep-alive
  body:
    mode: raw
    modeOfBody: JSON
    raw: |-
      {
        "data": {
          "hospital": {
            "systemId": "{{SYSTEM_ID}}",
            "metadata": {
              "allowedApplications": [
                "Prosight Assets",
                "Prosight Safety",
                "Prosight Environment"
              ],
              "timeZone": "{{hospitalDetails.timezone}}"
            },
            "data": {
              "address": {
                "zipCode": "{{hospitalDetails.zipCode}}",
                "city": "{{hospitalDetails.city}}",
                "street": "{{hospitalDetails.streetAddress}}",
                "state": "{{hospitalDetails.state}}"
              },
              "hospitalType": "Default",
              "timezone": "{{hospitalDetails.timezone}}",
              "contact": {
                "phone": "{{buildingDetails.contactPhoneNumber}}",
                "name": "{{buildingDetails.contactName}}",
                "email": "{{buildingDetails.contactEmail}}"
              },
              "name": "{{hospitalDetails.hospitalName}}",
              "position": {
                "lon": -92.016302,
                "lat": 30.222169
              },
              "openStaffDuressAlerts": {
                "test5": 0
              }
            },
            "purpose": "organization",
            "created": 1644009933179,
            "simulated": false,
            "name": "{{hospitalDetails.hospitalName}}",
            "id": "{{HospitalId}}",
            "lastModified": 1761556719623,
            "blueprintId": "{{hsptlBluePrintID}}",
            "projectId": "{{PROJECT_ID}}"
          },
          "name": "{{buildingDetails.buildingName}}",
          "addressDetails": {
            "streetAddress": "{{buildingDetails.streetAddress}}",
            "city": "{{buildingDetails.updatedcity}}",
            "state": "{{buildingDetails.state}}",
            "zipCode": "{{buildingDetails.zipCode}}"
          },
          "position": {
            "lat": 32.828866,
            "lon": -86.789292
          }
        },
        "name": "{{buildingDetails.buildingName}}"
      }
  auth:
    type: bearer
    bearer:
      token: '{{idToken}}'
events:
- listen: test
  script:
    type: javascript
    exec:
    - let response = pq.response.json();
    - if (pq.response.code === 200) {
    - '  pq.test("Validate building details", function () {'
    - '    let buildingDetails = pq.environment.get("buildingDetails");'
    - '    pq.expect(response.name).to.equal(buildingDetails.buildingName);'
    - '    pq.expect(response.data.name).to.equal(buildingDetails.buildingName);'
    - '    pq.expect(response.data.addressDetails.streetAddress).to.equal(buildingDetails.streetAddress);'
    - '    pq.expect(response.data.addressDetails.city).to.equal(buildingDetails.updatedcity);'
    - '    pq.expect(response.data.addressDetails.state).to.equal(buildingDetails.state);'
    - '    pq.expect(response.data.addressDetails.zipCode).to.equal(buildingDetails.zipCode);'
    - '  });'
    - '} else {'
    - '  console.log("building not found");'
    - '}'
type: request
