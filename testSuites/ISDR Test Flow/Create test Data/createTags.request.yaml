id: cd3aa52d-1e7b-4108-be78-f48c2305fa66
name: createTags
request:
  url:
    raw: '{{API_Base_URL}}/interface/{{SYSTEM_ID}}/hospital/{{HospitalId}}/tags'
    host:
      - '{{API_Base_URL}}'
    path:
      - interface
      - '{{SYSTEM_ID}}'
      - hospital
      - '{{HospitalId}}'
      - tags
  method: POST
  headers:
    - description: ''
      disabled: false
      key: Cache-Control
      value: no-cache
    - description: ''
      disabled: false
      key: Accept
      value: '*/*'
    - description: ''
      disabled: false
      key: Accept-Encoding
      value: gzip, deflate
    - description: ''
      disabled: false
      key: Connection
      value: keep-alive
  body:
    mode: raw
    modeOfBody: JSON
    raw: "{\r\n  \"networkAliases\": {\r\n    \"hid-beacons\": {\r\n      \"deviceId\": \"{{tagDetails.deviceId}}\"\r\n    }\r\n  },\r\n  \"networkId\": \"hid-beacons\",\r\n  \"data\": [\r\n    {\r\n      \"path\": \"uniqueDeviceId\",\r\n      \"value\": \"{{tagDetails.deviceId}}\"\r\n    },\r\n    {\r\n      \"path\": \"model\",\r\n      \"value\": \"{{tagDetails.model}}\"\r\n    },\r\n    {\r\n      \"path\": \"type\",\r\n      \"value\": \"{{tagDetails.type}}\"\r\n    },\r\n    {\r\n      \"path\": \"manufacturer\",\r\n      \"value\": \"{{tagDetails.manufacturer}}\"\r\n    }\r\n  ],\r\n  \"name\": \"{{tagDetails.deviceId}}\"\r\n}"
  auth:
    type: bearer
    bearer:
      token: '{{idToken}}'
events:
  - listen: test
    script:
      type: javascript
      exec:
        - "const response = pq.response.json();\r"
        - "const tagDetails = pq.environment.get('tagDetails')\r"
        - "\r"
        - "pq.test(\"Status code is 200\", function () {\r"
        - "      if (pq.response.code === 200) {\r"
        - "          pq.response.to.have.status(200);\r"
        - "          pq.test(\"Response has tag details\", function() {\r"
        - "              pq.expect(response.data.uniqueDeviceId).to.equal(tagDetails.deviceId);\r"
        - "              pq.expect(response.data.model).to.equal(tagDetails.model);\r"
        - "              pq.expect(response.data.type).to.equal(tagDetails.type);\r"
        - "              pq.expect(response.data.manufacturer).to.equal(tagDetails.manufacturer);      \r"
        - "          });\r"
        - "          pq.environment.set(\"tagId\", response.id);\r"
        - "      } else {\r"
        - "          console.log(\"Unable to create tags\");\r"
        - "      }\r"
        - '  });'
type: request
