id: f3804d7e-f05e-41f6-b1fe-63f388d7d2f5
name: searchFloorID
request:
  url:
    raw: >-
      {{API_Base_URL}}/interface/{{SYSTEM_ID}}/hospital/{{HOSPITAL_ID}}/floors.search
    host:
      - '{{API_Base_URL}}'
    path:
      - interface
      - '{{SYSTEM_ID}}'
      - hospital
      - '{{HOSPITAL_ID}}'
      - floors.search
  method: POST
  headers: []
  body:
    mode: raw
    modeOfBody: JSON
    raw: "{\r\n  \"limit\": 100,\r\n  \"offset\": 0,\r\n  \"filter\": {\r\n    \"type\": \"logical\",\r\n    \"operator\": \"and\",\r\n    \"conditions\": [\r\n      {\r\n        \"type\": \"groupedText\",\r\n        \"value\": \"{{itemName}}\"\r\n      }\r\n    ]\r\n  },\r\n  \"sort\": [\r\n    {\r\n      \"field\": \"created\",\r\n      \"order\": \"desc\"\r\n    }\r\n  ]\r\n}\r\n"
  auth:
    type: bearer
    bearer:
      token: '{{idToken}}'
events:
  - listen: prerequest
    script:
      type: javascript
      exec:
        - "const assetDetails=JSON.parse(pq.collectionVariables.get(\"assetDetails\")) \r"
        - pq.variables.set("itemName",assetDetails.floorDetails.floorName)
      packages: []
  - listen: test
    script:
      type: javascript
      exec:
        - "const response=pq.response.json()\r"
        - pq.variables.set("floorId",response.items[0].id)
      packages: []
